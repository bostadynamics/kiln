<div class="temp-display" data-pv="{{ pv }}" data-pattern="{{ pattern }}">
    <div class="temp-item">
        <span class="label">Current Temp.</span>
        <div>
            <span id="pv-value" class="value" style="color: {{ pv_color }}">{{ "%.1f"|format(pv) }}</span>
            <span class="unit">°C</span>
        </div>
    </div>
    <div class="temp-item">
        <span class="label">Target Temp.</span>
        <div>
            <span id="sv-value" class="value" style="color: #22c55e">{{ "%.1f"|format(setpoint) }}</span>
            <span class="unit">°C</span>
        </div>
    </div>
</div>

<div class="bars-container">
    <div class="bar-item">
        <div class="bar-header">
            <span>Output 1</span>
            <span id="out1-text">{{ output1 }}%</span>
        </div>
        <div class="progress-track">
            <div id="out1-bar" class="progress-fill" style="width: {{ output1 }}%"></div>
        </div>
    </div>

    <div class="bar-item">
        <div class="bar-header">
            <span>Output 2</span>
            <span id="out2-text">{{ output2 }}%</span>
        </div>
        <div class="progress-track">
            <div id="out2-bar" class="progress-fill out2" style="width: {{ output2 }}%"></div>
        </div>
    </div>
</div>

<div class="status-info"
    style="margin-top: 2rem; display: flex; justify-content: space-between; background: #252525; padding: 1rem; border-radius: 8px;">
    <div style="text-align: center;">
        <div class="label" style="font-size: 0.75rem;">Pattern</div>
        <div id="pattern-container" style="cursor: pointer;"
            onclick="document.getElementById('pattern-display').style.display='none'; document.getElementById('pattern-select').style.display='block'; document.getElementById('pattern-select').focus();">
            <div id="pattern-display" style="font-size: 1.25rem; font-weight: 600;">{{ pattern }}</div>
            <select id="pattern-select" name="value"
                style="display: none; font-size: 1rem; background: #333; color: white; border: 1px solid #555; border-radius: 4px;"
                hx-post="/pattern_start/update" hx-target="#dashboard-container" hx-trigger="change"
                onblur="this.style.display='none'; document.getElementById('pattern-display').style.display='block';">
                {% for i in range(8) %}
                <option value="{{ i }}" {% if i==start_pattern %}selected{% endif %}>{{ i }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    <div style="text-align: center;">
        <div class="label" style="font-size: 0.75rem;">Step</div>
        <div id="step-container" style="cursor: pointer;"
            onclick="document.getElementById('step-display').style.display='none'; document.getElementById('step-select').style.display='block'; document.getElementById('step-select').focus();">
            <div id="step-display" style="font-size: 1.25rem; font-weight: 600;">{{ step }}</div>
            <!-- <select id="step-select" name="value"
                style="display: none; font-size: 1rem; background: #333; color: white; border: 1px solid #555; border-radius: 4px;"
                hx-post="/pattern/{{ pattern }}/actual-steps/update" hx-target="#dashboard-container"
                hx-trigger="change"
                onblur="this.style.display='none'; document.getElementById('step-display').style.display='block';">
                {% for i in range(8) %}
                <option value="{{ i }}" {% if i==actual_steps %}selected{% endif %}>{{ i }}</option>
                {% endfor %}
            </select> -->
        </div>
    </div>
    <div style="text-align: center;">
        <div class="label" style="font-size: 0.75rem;">Time Left</div>
        <div style="font-size: 1.25rem; font-weight: 600;">{{ time_left }}</div>
    </div>
</div>

<div class="recording-controls"
    style="margin-top: 1.5rem; display: flex; align-items: center; justify-content: center; gap: 1rem;">
    <div style="display: flex; align-items: center; gap: 0.5rem;">
        <div
            style="width: 10px; height: 10px; border-radius: 50%; background: {% if is_recording %}#ef4444{% else %}#4b5563{% endif %}; {% if is_recording %}box-shadow: 0 0 8px #ef4444; animation: pulse 2s infinite;{% endif %}">
        </div>
        <span class="label" style="font-size: 0.875rem;">{% if is_recording %}Recording...{% else %}Stopped{% endif
            %}</span>
    </div>

    {% if is_recording %}
    <button hx-post="/recording/stop" hx-target="#dashboard-container"
        style="background: #374151; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-weight: 500;">
        Stop Recording
    </button>
    {% else %}
    <button hx-post="/recording/start" hx-target="#dashboard-container"
        style="background: #10b981; color: white; border: none; padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer; font-weight: 500;">
        Start Recording
    </button>
    {% endif %}
</div>

<style>
    @keyframes pulse {
        0% {
            opacity: 1;
        }

        50% {
            opacity: 0.5;
        }

        100% {
            opacity: 1;
        }
    }
</style>